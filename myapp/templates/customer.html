{% extends 'base.html' %}
{% load static %}

{% block content %}
    <main class="main-content position-relative max-height-vh-50 h-100 border-radius-lg ">
    
      <div class="container-fluid py-4">
        <div class="row">
          <div class="col-12">
            <div class="card my-4">
              <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
                  <h6 class="text-white text-capitalize ps-3">Customer table</h6>
                </div>
              </div>
              <div class="card-body px-0 pb-2">
                <div class="table-responsive p-0">
                  <table class="table align-items-center mb-0">
                    <thead>
                      <tr>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Customer Name</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Phone Number</th>
                        <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Date of Joining</th>
                        <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Subscription</th>
                        <th class="text-secondary opacity-7"></th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for i in data %}
                      <tr>
                        <td>
                          <div class="d-flex px-2 py-1">
                            <div class="d-flex flex-column justify-content-center">
                              <h6 class="mb-lg-0 text-sm">{{ i.fullname }}</h6>
                              <p class="text-xs text-secondary mb-0">{{ i.email }}</p>
                            </div>
                          </div>
                        </td>
                        <td>
                          <h6 class=" text-sm mb-0">{{i.phone}}</p>
                        </td>
                        <td class="align-middle text-center text-sm">
                          <h6 class=" text-sm mb-0">{{i.dop}}</p>
                        </td>
                        
                        <td class="align-middle text-center">
                        
                          <span class="text-secondary text-xs font-weight-bold">{{i.product_category}}</span>
                          <!-- <span class="text-secondary text-xs font-weight-bold">Personal Training</span> -->
                        
                        </td>
                        <td class="align-middle">
                          <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                            Edit
                          </a>
                        </td>
                      </tr>
                      {% endfor %}
                      </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
      </div>
      
  <div class="fixed-plugin">
    <a class="fixed-plugin-button text-dark position-fixed px-3 py-2">
      <i class="fa fa-plus py-2"> </i>
    </a>
    <div class="card shadow-lg">
      <div class="card-header pb-0 pt-3">
        <div class="float-start">
          <h5 class="mt-3 mb-0">Add New Customer</h5>
        </div>
        <div class="float-end mt-4">
          <button class="btn btn-link text-dark p-0 fixed-plugin-close-button">
            <i class="fa fa-close"></i>
          </button>
        </div>
        <!-- End Toggle Button  -->

      </div>
      <hr class="horizontal dark my-1" />
      <div class="card-body pt-sm-3 pt-0">
        <form method="post">
          {% csrf_token %}
          <div class="form-group">
            <label>Customer Name</label>
            <input
              name="name"
              type="text"
              class="form-control"
              placeholder="Enter Customer Name"
            />
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <input
              name="phone"
              type="number"
              class="form-control"
              placeholder="Enter Phone No."
            />
          </div>

          <div class="form-group">
            <label for="exampleInputEmail1">Date of Joining</label>
            <input
              name="dop"
              type="text"
              class="form-control"
              placeholder="Enter Date of Joining"
            />
  
          <div class="form-group">
            <label for="exampleInputEmail1">Product Category</label>
            <input
              name="product_category"
              type="text"
              class="form-control"
              placeholder="Enter Product Category"
            />
          </div>
          <hr class="horizontal dark my-sm-4" />
          <input class="btn bg-gradient-dark w-100" type="submit" value="ADD" />
        </form>
      </div>
    </div>
  </div>
  
  <div class="fixed-plugin edit">
    <div class="card shadow-lg">
      <div class="card-header pb-0 pt-3">
        <div class="float-start">
          <h5 class="mt-3 mb-0">Edit Customer</h5>
        </div>
        <div class="float-end mt-4">
          <button class="btn btn-link text-dark p-0 fixed-plugin-close-button">
            <i class="fa fa-close edit-close"></i>
          </button>
        </div>
        <!-- End Toggle Button -->
      </div>
      <hr class="horizontal dark my-1" />
      <div class="card-body pt-sm-3 pt-0">
        <form method="get">
          {% csrf_token %}
          <div class="form-group">
            <label>ID</label>
            <input
              name="id"
              type="text"
              class="form-control id"
              readonly
            />
          <div class="form-group">
            <label>Customer Name</label>
            <input
              name="fullname"
              type="text"
              class="form-control fullname"
              placeholder="Enter Customer Name"
  
            />
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <input
              name="phone"
              type="number"
              class="form-control phone"
              placeholder="Enter Phone Number"
            />
          </div>

          <div class="form-group">
            <label>Date of Joining</label>
            <input
              name="dop"
              type="text"
              class="form-control dop"
              placeholder="Enter Date of Joining"
            />
          </div>
  
          <div class="form-group">
            <label for="exampleInputEmail1">Product Category</label>
            <input
              name="product_category"
              type="text"
              class="form-control product_category"
              placeholder="Enter Product Category"
            />
          </div>

          <hr class="horizontal dark my-sm-4" />
          <input class="btn bg-gradient-dark w-100" type="submit" value="UPDATE" />
        </form>
      </div>
    </div>
  </div> 
</main>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
edit = document.querySelector(".edit");
edit_close = document.querySelector(".edit-close");
edit_close.addEventListener("click", () => {
  edit.classList.toggle("show");
});
btn_edit = document.querySelectorAll(".btn-edit");
btn_edit.forEach((i, j) => {
  i.addEventListener("click", () => {
    id = i.nextElementSibling.innerHTML;
    fetch("/products?id="+id)
      .then(function (response) {
        return response.json()
      }).then((res)=>{
        document.querySelector('.id').value = id
        form_name = document.querySelector('.name').value = res.name
        form_price = document.querySelector('.price').value = res.phone
        form_category = document.querySelector('.category').value = res.product_category
        console.log(res);
      })
      .catch(function (error) {
        console.log(error);
      });
    edit.classList.toggle("show");
  });
});

ele = document.querySelectorAll(".nav-link")
  ele.forEach((i,j)=>{
  if(i.getAttribute('href') == "/products/"){
      i.classList.toggle("active")
  }
  })
</script>   
  
 

{% endblock %}